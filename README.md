# deepseek_api
一个基于Python tkinter的DeepSeek API调用工具，支持角色管理、流式响应和多角色协同对话、。它提供的功能足够基础，所以它的作用也很广泛，只要你想得到。非常适合调试角色提示词。
## 快速体验
   已打包的程序
   链接: https://pan.baidu.com/s/1w5zCsn5grzktO_nZmJQvLw?pwd=tqgv 提取码: tqgv 

## 📋 功能特性

### 核心功能
- 🔄 **多角色协同对话**：支持多个AI角色按顺序对话，形成角色间的互动
- 📑 **多标签页管理**：每个标签页可独立配置不同角色和对话历史
- 🌊 **流式响应**：实时显示AI生成内容，提升交互体验
- 🔑 **API配置管理**：支持自定义API Key、Base URL和超时设置
- 📊 **Token统计**：实时统计输入/输出Token使用量

### 角色管理
- 👥 **全局角色池**：保存和管理多个角色配置
- ⚙️ **角色自定义**：可配置系统提示词、温度、最大tokens等参数
- 📁 **导入导出**：支持角色配置的导入导出功能
- 🔄 **角色复用**：可在多个标签页中复用同一角色

### 对话功能
- 💬 **完整对话历史**：保存完整的对话记录
- 🗑️ **历史管理**：支持清空对话历史
- 📝 **会话保存**：自动保存对话历史到日志文件
- 🔍 **标签页搜索**：快速查找和切换到特定标签页

### 多角色协同特色
- 🔗 **连接词配置**：自定义角色间的过渡语句
- 🔄 **循环对话**：支持设置对话循环次数
- 🔗 **首尾相连**：可选形成完整的对话循环
- 💭 **保持初衷**：每轮对话可重新加入初始提示
- 📋 **配置复制**：快速复制多角色协同配置

## 🚀 安装步骤

### 环境要求
- Python 3.7+
- Windows/Linux/macOS

### 1. 克隆或下载项目
```bash
git clone <仓库地址>
cd deepseek_api
```

### 2. 安装依赖
```bash
pip install -r requirements.txt
```

如果没有requirements.txt，请手动安装：
```bash
pip install requests
```

### 3. 获取API Key
1. 访问 [DeepSeek官网](https://platform.deepseek.com/)
2. 注册并登录账户
3. 在API Keys页面创建新的API Key
4. 复制API Key备用

## 🎮 使用说明

### 启动程序
```bash
python     deepseek_api.py
```

### 界面布局

#### 顶部工具栏
1. **API配置区域**
   - API Key输入框（可显示/隐藏）
   - Base URL设置
   - 超时时间设置
   - 流式响应开关

2. **Token统计区域**
   - 显示总输入/输出Token数
   - 刷新按钮更新统计

3. **角色管理按钮**
   - 导入角色配置
   - 导出角色配置

#### 第二行工具栏
- **👤 新建角色**：创建新的角色标签页
- **🤝 多角色协同**：创建优化版多角色协同标签页
- **🗑️ 关闭当前**：关闭当前激活的标签页
- **🔍 搜索标签页**：搜索和快速切换标签页

### 基础使用流程

#### 1. 配置API
1. 在API配置区域输入您的DeepSeek API Key
2. （可选）调整Base URL、超时时间等设置

#### 2. 创建角色标签页
1. 点击"👤 新建角色"按钮
2. 从角色选择对话框中选择一个预设角色
3. 新的标签页将自动创建并加载所选角色

#### 3. 进行对话
1. 在输入框中输入您的问题或提示
2. 点击"发送"按钮或按`Ctrl+Enter`发送
3. AI的回复将实时显示在对话区域

### 角色管理

#### 新建/编辑角色
1. 在角色标签页中，可以：
   - 修改角色名称
   - 编辑系统提示词
   - 调整温度参数（0.1-2.0）
   - 设置最大tokens数（100-8000）
   - 启用/禁用深度思考模式

2. 点击"保存"按钮可将当前配置保存到全局角色池

#### 导入导出角色
1. **导入角色**：点击"导入角色"按钮，选择JSON格式的角色配置文件
2. **导出角色**：点击"导出角色"按钮，保存当前所有角色配置到JSON文件

### 多角色协同使用

#### 创建多角色协同
1. 点击"🤝 多角色协同"按钮创建新的多角色协同标签页
2. 确保至少有两个角色可用于协同

#### 配置多角色协同
1. **添加角色**：
   - 在"可用角色"列表中选择角色
   - 点击"▶ 添加"添加到顺序列表
   - 可重复添加同一角色

2. **调整顺序**：
   - 使用"↑ 上移"/"↓ 下移"按钮调整角色顺序
   - 点击"◀ 移除"从顺序列表中移除角色

3. **配置连接词**：
   - 为每对角色间的关系配置连接词
   - 连接词将作为角色间对话的过渡语句

4. **设置对话参数**：
   - **首尾相连**：使最后一个角色的回复传递给第一个角色，形成循环
   - **保持初衷**：每轮对话开始时重新加入初始提示
   - **循环次数**：设置对话进行的轮数

5. **初始提示**：
   - 在初始提示文本框中输入对话的起始内容

#### 启动多角色对话
1. 点击"▶️ 开始对话"按钮启动多角色对话
2. 对话将按配置的角色顺序和循环次数进行
3. 可随时点击"⏹️ 停止对话"按钮停止对话

### 标签页管理

#### 切换标签页
- 直接点击标签页标题进行切换
- 使用"🔍 搜索标签页"功能快速查找

#### 关闭标签页
- 点击"🗑️ 关闭当前"按钮关闭当前标签页
- 关闭前会提示是否保存角色配置

### 日志管理

#### 日志文件位置
- API调用日志保存在`api_logs/`目录下
- 按日期创建子目录（格式：YYYY-MM-DD）
- 每个API调用保存为单独的JSON文件

#### 日志内容
- 时间戳
- 角色名称
- API请求和响应数据
- Token使用情况

## ⚙️ 配置说明

### 默认角色
程序内置了4个默认角色：
1. **编程助手**：帮助解决编程问题
2. **创意写作**：协助创意写作任务
3. **学术研究**：支持学术研究和分析
4. **翻译助手**：提供多语言翻译服务

### 配置文件
- **全局角色配置**：`global_roles.json`
- **多角色协同配置**：`multi_role_config_<tab_id>.json`
- **API日志**：`api_logs/<日期>/`目录下的JSON文件

## 🔧 高级功能

### 流式响应
- 启用流式响应可获得实时打字机效果
- 点击"停止"按钮可中断流式响应

### 深度思考模式
- 在角色配置中启用深度思考
- 适用于需要复杂推理的场景

### Token统计
- 实时统计每个标签页的Token使用量
- 全局累计统计所有标签页的总Token使用量

## ❓ 常见问题

### Q: API Key在哪里获取？
A: 访问DeepSeek官网，注册账户后在API Keys页面创建。

### Q: 如何添加自定义角色？
A: 在角色标签页中配置角色参数，点击"保存"按钮即可。

### Q: 多角色协同最多支持多少个角色？
A: 理论上无限制，但建议控制在5-8个以内以获得最佳效果。

### Q: 对话历史会保存吗？
A: 是的，对话历史会自动保存到本地日志文件中。

### Q: 如何导出对话记录？
A: 目前支持通过API日志导出JSON格式的对话记录。

### Q: 程序支持哪些操作系统？
A: 支持Windows、macOS和Linux系统。

## 📁 项目结构

```
deepseek_api/
├── deepseek_api.py                    # 主程序入口
├── global_roles.json         # 全局角色配置文件
├── multi_role_config_*.json  # 多角色协同配置
├── api_logs/                 # API调用日志目录
│   └── YYYY-MM-DD/          # 按日期组织的日志文件
├── README.md                # 说明文档
└── requirements.txt         # 依赖包列表
```

## 🐛 故障排除

### 无法启动程序
- 确保已安装Python 3.7+
- 检查是否已安装requests库：`pip install requests`

### API调用失败
- 检查API Key是否正确
- 确认网络连接正常
- 查看API日志了解详细错误信息

### 界面显示异常
- 尝试调整窗口大小
- 确保系统支持中文字体

### 角色配置丢失
- 定期导出角色配置进行备份
- 检查global_roles.json文件权限

## 📄 许可证

本项目仅供学习和研究使用，请遵守DeepSeek API使用条款。

## 🤝 贡献指南

欢迎提交Issue和Pull Request来改进这个项目。

## 📞 支持

如有问题或建议，请通过以下方式联系：
- 提交GitHub Issue
- 查看API日志获取详细错误信息

---

**版本**: v0.5.012109  
**兼容性**: DeepSeek API v1
